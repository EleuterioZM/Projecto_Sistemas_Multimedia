(function(l){typeof exports=="object"&&typeof module=="object"?l(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],l):l(CodeMirror)})(function(l){"use strict";l.defineMode("commonlisp",function(f){var d=/^(block|let*|return-from|catch|load-time-value|setq|eval-when|locally|symbol-macrolet|flet|macrolet|tagbody|function|multiple-value-call|the|go|multiple-value-prog1|throw|if|progn|unwind-protect|labels|progv|let|quote)$/,u=/^with|^def|^do|^prog|case$|^cond$|bind$|when$|unless$/,p=/^(?:[+\-]?(?:\d+|\d*\.\d+)(?:[efd][+\-]?\d+)?|[+\-]?\d+(?:\/[+\-]?\d+)?|#b[+\-]?[01]+|#o[+\-]?[0-7]+|#x[+\-]?[\da-f]+)/,x=/[^\s'`,@()\[\]";]/,i;function o(e){for(var n;n=e.next();)if(n=="\\")e.next();else if(!x.test(n)){e.backUp(1);break}return e.current()}function c(e,n){if(e.eatSpace())return i="ws",null;if(e.match(p))return"number";var t=e.next();if(t=="\\"&&(t=e.next()),t=='"')return(n.tokenize=s)(e,n);if(t=="(")return i="open","bracket";if(t==")"||t=="]")return i="close","bracket";if(t==";")return e.skipToEnd(),i="ws","comment";if(/['`,@]/.test(t))return null;if(t=="|")return e.skipTo("|")?(e.next(),"symbol"):(e.skipToEnd(),"error");if(t=="#"){var t=e.next();return t=="("?(i="open","bracket"):/[+\-=\.']/.test(t)||/\d/.test(t)&&e.match(/^\d*#/)?null:t=="|"?(n.tokenize=b)(e,n):t==":"?(o(e),"meta"):t=="\\"?(e.next(),o(e),"string-2"):"error"}else{var r=o(e);return r=="."?null:(i="symbol",r=="nil"||r=="t"||r.charAt(0)==":"?"atom":n.lastType=="open"&&(d.test(r)||u.test(r))?"keyword":r.charAt(0)=="&"?"variable-2":"variable")}}function s(e,n){for(var t=!1,r;r=e.next();){if(r=='"'&&!t){n.tokenize=c;break}t=!t&&r=="\\"}return"string"}function b(e,n){for(var t,r;t=e.next();){if(t=="#"&&r=="|"){n.tokenize=c;break}r=t}return i="ws","comment"}return{startState:function(){return{ctx:{prev:null,start:0,indentTo:0},lastType:null,tokenize:c}},token:function(e,n){e.sol()&&typeof n.ctx.indentTo!="number"&&(n.ctx.indentTo=n.ctx.start+1),i=null;var t=n.tokenize(e,n);return i!="ws"&&(n.ctx.indentTo==null?i=="symbol"&&u.test(e.current())?n.ctx.indentTo=n.ctx.start+f.indentUnit:n.ctx.indentTo="next":n.ctx.indentTo=="next"&&(n.ctx.indentTo=e.column()),n.lastType=i),i=="open"?n.ctx={prev:n.ctx,start:e.column(),indentTo:null}:i=="close"&&(n.ctx=n.ctx.prev||n.ctx),t},indent:function(e,n){var t=e.ctx.indentTo;return typeof t=="number"?t:e.ctx.start+1},closeBrackets:{pairs:'()[]{}""'},lineComment:";;",fold:"brace-paren",blockCommentStart:"#|",blockCommentEnd:"|#"}}),l.defineMIME("text/x-common-lisp","commonlisp")});
