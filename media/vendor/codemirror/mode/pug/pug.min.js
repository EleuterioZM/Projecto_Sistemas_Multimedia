(function(t){typeof exports=="object"&&typeof module=="object"?t(require("../../lib/codemirror"),require("../javascript/javascript"),require("../css/css"),require("../htmlmixed/htmlmixed")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../javascript/javascript","../css/css","../htmlmixed/htmlmixed"],t):t(CodeMirror)})(function(t){"use strict";t.defineMode("pug",function(u){var r="keyword",d="meta",S="builtin",v="qualifier",a={"{":"}","(":")","[":"]"},c=t.getMode(u,"javascript");function f(){this.javaScriptLine=!1,this.javaScriptLineExcludesColon=!1,this.javaScriptArguments=!1,this.javaScriptArgumentsDepth=0,this.isInterpolating=!1,this.interpolationNesting=0,this.jsState=t.startState(c),this.restOfLine="",this.isIncludeFiltered=!1,this.isEach=!1,this.lastTag="",this.scriptType="",this.isAttrs=!1,this.attrsNest=[],this.inAttributeName=!0,this.attributeIsType=!1,this.attrValue="",this.indentOf=1/0,this.indentToken="",this.innerMode=null,this.innerState=null,this.innerModeForLine=!1}f.prototype.copy=function(){var i=new f;return i.javaScriptLine=this.javaScriptLine,i.javaScriptLineExcludesColon=this.javaScriptLineExcludesColon,i.javaScriptArguments=this.javaScriptArguments,i.javaScriptArgumentsDepth=this.javaScriptArgumentsDepth,i.isInterpolating=this.isInterpolating,i.interpolationNesting=this.interpolationNesting,i.jsState=t.copyState(c,this.jsState),i.innerMode=this.innerMode,this.innerMode&&this.innerState&&(i.innerState=t.copyState(this.innerMode,this.innerState)),i.restOfLine=this.restOfLine,i.isIncludeFiltered=this.isIncludeFiltered,i.isEach=this.isEach,i.lastTag=this.lastTag,i.scriptType=this.scriptType,i.isAttrs=this.isAttrs,i.attrsNest=this.attrsNest.slice(),i.inAttributeName=this.inAttributeName,i.attributeIsType=this.attributeIsType,i.attrValue=this.attrValue,i.indentOf=this.indentOf,i.indentToken=this.indentToken,i.innerModeForLine=this.innerModeForLine,i};function j(i,n){if(i.sol()&&(n.javaScriptLine=!1,n.javaScriptLineExcludesColon=!1),n.javaScriptLine){if(n.javaScriptLineExcludesColon&&i.peek()===":"){n.javaScriptLine=!1,n.javaScriptLineExcludesColon=!1;return}var e=c.token(i,n.jsState);return i.eol()&&(n.javaScriptLine=!1),e||!0}}function g(i,n){if(n.javaScriptArguments){if(n.javaScriptArgumentsDepth===0&&i.peek()!=="("){n.javaScriptArguments=!1;return}if(i.peek()==="("?n.javaScriptArgumentsDepth++:i.peek()===")"&&n.javaScriptArgumentsDepth--,n.javaScriptArgumentsDepth===0){n.javaScriptArguments=!1;return}var e=c.token(i,n.jsState);return e||!0}}function b(i){if(i.match(/^yield\b/))return"keyword"}function L(i){if(i.match(/^(?:doctype) *([^\n]+)?/))return d}function p(i,n){if(i.match("#{"))return n.isInterpolating=!0,n.interpolationNesting=0,"punctuation"}function A(i,n){if(n.isInterpolating){if(i.peek()==="}"){if(n.interpolationNesting--,n.interpolationNesting<0)return i.next(),n.isInterpolating=!1,"punctuation"}else i.peek()==="{"&&n.interpolationNesting++;return c.token(i,n.jsState)||!0}}function y(i,n){if(i.match(/^case\b/))return n.javaScriptLine=!0,r}function x(i,n){if(i.match(/^when\b/))return n.javaScriptLine=!0,n.javaScriptLineExcludesColon=!0,r}function T(i){if(i.match(/^default\b/))return r}function k(i,n){if(i.match(/^extends?\b/))return n.restOfLine="string",r}function I(i,n){if(i.match(/^append\b/))return n.restOfLine="variable",r}function N(i,n){if(i.match(/^prepend\b/))return n.restOfLine="variable",r}function O(i,n){if(i.match(/^block\b *(?:(prepend|append)\b)?/))return n.restOfLine="variable",r}function w(i,n){if(i.match(/^include\b/))return n.restOfLine="string",r}function E(i,n){if(i.match(/^include:([a-zA-Z0-9\-]+)/,!1)&&i.match("include"))return n.isIncludeFiltered=!0,r}function F(i,n){if(n.isIncludeFiltered){var e=o(i,n);return n.isIncludeFiltered=!1,n.restOfLine="string",e}}function M(i,n){if(i.match(/^mixin\b/))return n.javaScriptLine=!0,r}function D(i,n){if(i.match(/^\+([-\w]+)/))return i.match(/^\( *[-\w]+ *=/,!1)||(n.javaScriptArguments=!0,n.javaScriptArgumentsDepth=0),"variable";if(i.match("+#{",!1))return i.next(),n.mixinCallAfter=!0,p(i,n)}function C(i,n){if(n.mixinCallAfter)return n.mixinCallAfter=!1,i.match(/^\( *[-\w]+ *=/,!1)||(n.javaScriptArguments=!0,n.javaScriptArgumentsDepth=0),!0}function V(i,n){if(i.match(/^(if|unless|else if|else)\b/))return n.javaScriptLine=!0,r}function q(i,n){if(i.match(/^(- *)?(each|for)\b/))return n.isEach=!0,r}function R(i,n){if(n.isEach){if(i.match(/^ in\b/))return n.javaScriptLine=!0,n.isEach=!1,r;if(i.sol()||i.eol())n.isEach=!1;else if(i.next()){for(;!i.match(/^ in\b/,!1)&&i.next(););return"variable"}}}function Y(i,n){if(i.match(/^while\b/))return n.javaScriptLine=!0,r}function z(i,n){var e;if(e=i.match(/^(\w(?:[-:\w]*\w)?)\/?/))return n.lastTag=e[1].toLowerCase(),n.lastTag==="script"&&(n.scriptType="application/javascript"),"tag"}function o(i,n){if(i.match(/^:([\w\-]+)/)){var e;return u&&u.innerModes&&(e=u.innerModes(i.current().substring(1))),e||(e=i.current().substring(1)),typeof e=="string"&&(e=t.getMode(u,e)),l(i,n,e),"atom"}}function B(i,n){if(i.match(/^(!?=|-)/))return n.javaScriptLine=!0,"punctuation"}function K(i){if(i.match(/^#([\w-]+)/))return S}function P(i){if(i.match(/^\.([\w-]+)/))return v}function U(i,n){if(i.peek()=="(")return i.next(),n.isAttrs=!0,n.attrsNest=[],n.inAttributeName=!0,n.attrValue="",n.attributeIsType=!1,"punctuation"}function h(i,n){if(n.isAttrs){if(a[i.peek()]&&n.attrsNest.push(a[i.peek()]),n.attrsNest[n.attrsNest.length-1]===i.peek())n.attrsNest.pop();else if(i.eat(")"))return n.isAttrs=!1,"punctuation";if(n.inAttributeName&&i.match(/^[^=,\)!]+/))return(i.peek()==="="||i.peek()==="!")&&(n.inAttributeName=!1,n.jsState=t.startState(c),n.lastTag==="script"&&i.current().trim().toLowerCase()==="type"?n.attributeIsType=!0:n.attributeIsType=!1),"attribute";var e=c.token(i,n.jsState);if(n.attributeIsType&&e==="string"&&(n.scriptType=i.current().toString()),n.attrsNest.length===0&&(e==="string"||e==="variable"||e==="keyword"))try{return Function("","var x "+n.attrValue.replace(/,\s*$/,"").replace(/^!/,"")),n.inAttributeName=!0,n.attrValue="",i.backUp(i.current().length),h(i,n)}catch{}return n.attrValue+=i.current(),e||!0}}function W(i,n){if(i.match(/^&attributes\b/))return n.javaScriptArguments=!0,n.javaScriptArgumentsDepth=0,"keyword"}function Z(i){if(i.sol()&&i.eatSpace())return"indent"}function _(i,n){if(i.match(/^ *\/\/(-)?([^\n]*)/))return n.indentOf=i.indentation(),n.indentToken="comment","comment"}function $(i){if(i.match(/^: */))return"colon"}function m(i,n){if(i.match(/^(?:\| ?| )([^\n]+)/))return"string";if(i.match(/^(<[^\n]*)/,!1))return l(i,n,"htmlmixed"),n.innerModeForLine=!0,s(i,n,!0)}function G(i,n){if(i.eat(".")){var e=null;return n.lastTag==="script"&&n.scriptType.toLowerCase().indexOf("javascript")!=-1?e=n.scriptType.toLowerCase().replace(/"|'/g,""):n.lastTag==="style"&&(e="css"),l(i,n,e),"dot"}}function H(i){return i.next(),null}function l(i,n,e){e=t.mimeModes[e]||e,e=u.innerModes&&u.innerModes(e)||e,e=t.mimeModes[e]||e,e=t.getMode(u,e),n.indentOf=i.indentation(),e&&e.name!=="null"?n.innerMode=e:n.indentToken="string"}function s(i,n,e){if(i.indentation()>n.indentOf||n.innerModeForLine&&!i.sol()||e)return n.innerMode?(n.innerState||(n.innerState=n.innerMode.startState?t.startState(n.innerMode,i.indentation()):{}),i.hideFirstChars(n.indentOf+2,function(){return n.innerMode.token(i,n.innerState)||!0})):(i.skipToEnd(),n.indentToken);i.sol()&&(n.indentOf=1/0,n.indentToken=null,n.innerMode=null,n.innerState=null)}function J(i,n){if(i.sol()&&(n.restOfLine=""),n.restOfLine){i.skipToEnd();var e=n.restOfLine;return n.restOfLine="",e}}function Q(){return new f}function X(i){return i.copy()}function ii(i,n){var e=s(i,n)||J(i,n)||A(i,n)||F(i,n)||R(i,n)||h(i,n)||j(i,n)||g(i,n)||C(i,n)||b(i)||L(i)||p(i,n)||y(i,n)||x(i,n)||T(i)||k(i,n)||I(i,n)||N(i,n)||O(i,n)||w(i,n)||E(i,n)||M(i,n)||D(i,n)||V(i,n)||q(i,n)||Y(i,n)||z(i,n)||o(i,n)||B(i,n)||K(i)||P(i)||U(i,n)||W(i,n)||Z(i)||m(i,n)||_(i,n)||$(i)||G(i,n)||H(i);return e===!0?null:e}return{startState:Q,copyState:X,token:ii}},"javascript","css","htmlmixed"),t.defineMIME("text/x-pug","pug"),t.defineMIME("text/x-jade","pug")});
