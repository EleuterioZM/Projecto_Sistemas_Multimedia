(function(s){typeof exports=="object"&&typeof module=="object"?s(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],s):s(CodeMirror)})(function(s){"use strict";var h=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,k=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,w=/[*+-]\s/;s.commands.newlineAndIndentContinueMarkdownList=function(e){if(e.getOption("disableInput"))return s.Pass;for(var v=e.listSelections(),d=[],i=0;i<v.length;i++){var a=v[i].head,t=e.getStateAfter(a.line),l=s.innerMode(e.getMode(),t);if(l.mode.name!=="markdown"&&l.mode.helperType!=="markdown"){e.execCommand("newlineAndIndent");return}else t=l.state;var g=t.list!==!1,o=t.quote!==0,n=e.getLine(a.line),r=h.exec(n),c=/^\s*$/.test(n.slice(0,a.ch));if(!v[i].empty()||!g&&!o||!r||c){e.execCommand("newlineAndIndent");return}if(k.test(n)){var f=o&&/>\s*$/.test(n),p=!/>\s*$/.test(n);(f||p)&&e.replaceRange("",{line:a.line,ch:0},{line:a.line,ch:a.ch+1}),d[i]=`
`}else{var R=r[1],A=r[5],u=!(w.test(r[2])||r[2].indexOf(">")>=0),L=u?parseInt(r[3],10)+1+r[4]:r[2].replace("x"," ");d[i]=`
`+R+L+A,u&&y(e,a)}}e.replaceSelections(d)};function y(e,v){var d=v.line,i=0,a=0,t=h.exec(e.getLine(d)),l=t[1];do{i+=1;var g=d+i,o=e.getLine(g),n=h.exec(o);if(n){var r=n[1],c=parseInt(t[3],10)+i-a,f=parseInt(n[3],10),p=f;if(l===r&&!isNaN(f))c===f&&(p=f+1),c>f&&(p=c+1),e.replaceRange(o.replace(h,r+p+n[4]+n[5]),{line:g,ch:0},{line:g,ch:o.length});else{if(l.length>r.length||l.length<r.length&&i===1)return;a+=1}}}while(n)}});
