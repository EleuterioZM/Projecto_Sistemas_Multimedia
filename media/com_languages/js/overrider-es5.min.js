(function(){"use strict";/**
 * @copyright  (C) 2018 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */(function(n,e){var f=function(){function g(){this.states={refreshing:!1,refreshed:!1,counter:0,searchString:"",searchType:"value"},this.spinner=e.getElementById("overrider-spinner"),this.spinnerBtn=e.getElementById("overrider-spinner-btn"),this.moreResults=e.getElementById("more-results"),this.moreResultsButton=e.getElementById("more-results-button"),this.resultsContainer=e.getElementById("results-container"),this.refreshStatus=e.getElementById("refresh-status")}var c=g.prototype;return c.refreshCache=function(){var a=this;this.states.refreshing=!0,this.refreshStatus.classList.add("show"),n.request({url:"index.php?option=com_languages&task=strings.refresh&format=json",method:"POST",headers:{"Content-Type":"application/json"},onSuccess:function(s){s.error&&s.message&&alert(s.message),s.messages&&n.renderMessages(s.messages),a.refreshStatus.classList.remove("show"),a.states.refreshing=!1},onError:function(){alert(n.Text._("COM_LANGUAGES_VIEW_OVERRIDE_REQUEST_ERROR")),a.refreshStatus.classList.remove("show")}})},c.searchStrings=function(a){var r=this;if(!this.states.refreshing){var s=e.getElementById("jform_searchstring"),u=e.getElementById("jform_searchtype");if(!a){this.states.searchString=s.value,this.states.searchType=u.value||"value";var o=[].slice.call(e.querySelectorAll(".language-results"));o.forEach(function(t){t.parentNode.removeChild(t)})}if(!this.states.searchString){s.classList.add("invalid");return}if(a)this.spinnerBtn.classList.add("show");else{this.moreResults.classList.remove("show");var h=[].slice.call(e.querySelectorAll("#results-container div.language-results"));h.forEach(function(t){t.parentNode.removeChild(t)}),this.resultsContainer.classList.add("show"),this.spinner.classList.add("show")}n.request({url:"index.php?option=com_languages&task=strings.search&format=json&searchstring="+this.states.searchString+"&searchtype="+this.states.searchType+"&more="+a,method:"POST",headers:{"Content-Type":"application/json"},onSuccess:function(l){var i=JSON.parse(l);i.error&&i.message&&alert(i.message),i.messages&&n.renderMessages(i.messages),i.data&&(i.data.results&&n.overrider.insertResults(i.data.results),i.data.more?(r.states.more=i.data.more,r.moreResultsButton.disabled=!1,r.moreResults.classList.add("show")):(r.moreResultsButton.disabled=!0,r.moreResults.classList.remove("show"))),r.spinnerBtn.classList.remove("show"),r.spinner.classList.remove("show")},onError:function(){alert(n.Text._("COM_LANGUAGES_VIEW_OVERRIDE_REQUEST_ERROR")),r.moreResultsButton.disabled=!0,r.moreResults.classList.remove("show"),r.resultsContainer.classList.remove("show")}})}},c.insertResults=function(a){var r=this;this.states.counter+=1;var s=e.createElement("div");if(s.setAttribute("id","language-results"+this.states.counter),s.classList.add("language-results"),s.classList.add("list-group"),s.classList.add("mb-2"),s.classList.add("show"),a.forEach(function(o,h){var t=e.createElement("a");t.setAttribute("onclick","Joomla.overrider.selectString("+r.states.counter+h+");"),t.setAttribute("href","#"),t.classList.add("list-group-item"),t.classList.add("list-group-item-action"),t.classList.add("flex-column"),t.classList.add("align-items-start");var l=e.createElement("div");l.setAttribute("id","override_key"+r.states.counter+h),l.setAttribute("title",o.file),l.classList.add("result-key"),l.innerHTML=n.sanitizeHtml(o.constant);var i=e.createElement("div");i.setAttribute("id","override_string"+r.states.counter+h),i.classList.add("result-string"),i.innerHTML=n.sanitizeHtml(o.string),t.appendChild(l),t.appendChild(i),s.appendChild(t)}),!a.length){var u=e.createElement("div");u.innerText=n.Text._("COM_LANGUAGES_VIEW_OVERRIDE_NO_RESULTS"),s.appendChild(u)}this.moreResults&&this.moreResults.parentNode.insertBefore(s,this.moreResults)},c.selectString=function(a){e.getElementById("jform_key").value=e.getElementById("override_key"+a).innerHTML,e.getElementById("jform_override").value=e.getElementById("override_string"+a).innerHTML},g}();e.addEventListener("DOMContentLoaded",function(){n.overrider=new f})})(Joomla,document)})();
