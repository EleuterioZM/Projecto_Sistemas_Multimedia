(function(){"use strict";function R(){R=function(){return a};var i,a={},f=Object.prototype,n=f.hasOwnProperty,u=Object.defineProperty||function(e,t,r){e[t]=r.value},y=typeof Symbol=="function"?Symbol:{},p=y.iterator||"@@iterator",m=y.asyncIterator||"@@asyncIterator",v=y.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch{l=function(t,r,c){return t[r]=c}}function U(e,t,r,c){var o=t&&t.prototype instanceof A?t:A,s=Object.create(o.prototype),h=new K(c||[]);return u(s,"_invoke",{value:ot(e,r,h)}),s}function _(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(c){return{type:"throw",arg:c}}}a.wrap=U;var g="suspendedStart",S="suspendedYield",x="executing",P="completed",k={};function A(){}function N(){}function b(){}var d={};l(d,p,function(){return this});var E=Object.getPrototypeOf,M=E&&E(E(Y([])));M&&M!==f&&n.call(M,p)&&(d=M);var L=b.prototype=A.prototype=Object.create(d);function D(e){["next","throw","return"].forEach(function(t){l(e,t,function(r){return this._invoke(t,r)})})}function T(e,t){function r(o,s,h,w){var O=_(e[o],e,s);if(O.type!=="throw"){var I=O.arg,F=I.value;return F&&typeof F=="object"&&n.call(F,"__await")?t.resolve(F.__await).then(function(j){r("next",j,h,w)},function(j){r("throw",j,h,w)}):t.resolve(F).then(function(j){I.value=j,h(I)},function(j){return r("throw",j,h,w)})}w(O.arg)}var c;u(this,"_invoke",{value:function(o,s){function h(){return new t(function(w,O){r(o,s,w,O)})}return c=c?c.then(h,h):h()}})}function ot(e,t,r){var c=g;return function(o,s){if(c===x)throw new Error("Generator is already running");if(c===P){if(o==="throw")throw s;return{value:i,done:!0}}for(r.method=o,r.arg=s;;){var h=r.delegate;if(h){var w=H(h,r);if(w){if(w===k)continue;return w}}if(r.method==="next")r.sent=r._sent=r.arg;else if(r.method==="throw"){if(c===g)throw c=P,r.arg;r.dispatchException(r.arg)}else r.method==="return"&&r.abrupt("return",r.arg);c=x;var O=_(e,t,r);if(O.type==="normal"){if(c=r.done?P:S,O.arg===k)continue;return{value:O.arg,done:r.done}}O.type==="throw"&&(c=P,r.method="throw",r.arg=O.arg)}}}function H(e,t){var r=t.method,c=e.iterator[r];if(c===i)return t.delegate=null,r==="throw"&&e.iterator.return&&(t.method="return",t.arg=i,H(e,t),t.method==="throw")||r!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),k;var o=_(c,e.iterator,t.arg);if(o.type==="throw")return t.method="throw",t.arg=o.arg,t.delegate=null,k;var s=o.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=i),t.delegate=null,k):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,k)}function it(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function W(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function K(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(it,this),this.reset(!0)}function Y(e){if(e||e===""){var t=e[p];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var r=-1,c=function o(){for(;++r<e.length;)if(n.call(e,r))return o.value=e[r],o.done=!1,o;return o.value=i,o.done=!0,o};return c.next=c}}throw new TypeError(typeof e+" is not iterable")}return N.prototype=b,u(L,"constructor",{value:b,configurable:!0}),u(b,"constructor",{value:N,configurable:!0}),N.displayName=l(b,v,"GeneratorFunction"),a.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return!!t&&(t===N||(t.displayName||t.name)==="GeneratorFunction")},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,v,"GeneratorFunction")),e.prototype=Object.create(L),e},a.awrap=function(e){return{__await:e}},D(T.prototype),l(T.prototype,m,function(){return this}),a.AsyncIterator=T,a.async=function(e,t,r,c,o){o===void 0&&(o=Promise);var s=new T(U(e,t,r,c),o);return a.isGeneratorFunction(t)?s:s.next().then(function(h){return h.done?h.value:s.next()})},D(L),l(L,v,"Generator"),l(L,p,function(){return this}),l(L,"toString",function(){return"[object Generator]"}),a.keys=function(e){var t=Object(e),r=[];for(var c in t)r.push(c);return r.reverse(),function o(){for(;r.length;){var s=r.pop();if(s in t)return o.value=s,o.done=!1,o}return o.done=!0,o}},a.values=Y,K.prototype={constructor:K,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(W),!e)for(var t in this)t.charAt(0)==="t"&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=i)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(O,I){return s.type="throw",s.arg=e,t.next=O,I&&(t.method="next",t.arg=i),!!I}for(var c=this.tryEntries.length-1;c>=0;--c){var o=this.tryEntries[c],s=o.completion;if(o.tryLoc==="root")return r("end");if(o.tryLoc<=this.prev){var h=n.call(o,"catchLoc"),w=n.call(o,"finallyLoc");if(h&&w){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(h){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!w)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var c=this.tryEntries[r];if(c.tryLoc<=this.prev&&n.call(c,"finallyLoc")&&this.prev<c.finallyLoc){var o=c;break}}o&&(e==="break"||e==="continue")&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,k):this.complete(s)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),k},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),W(r),k}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var c=r.completion;if(c.type==="throw"){var o=c.arg;W(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:Y(e),resultName:t,nextLoc:r},this.method==="next"&&(this.arg=i),k}},a}function q(i,a,f,n,u,y,p){try{var m=i[y](p),v=m.value}catch(l){f(l);return}m.done?a(v):Promise.resolve(v).then(n,u)}function Q(i){return function(){var a=this,f=arguments;return new Promise(function(n,u){var y=i.apply(a,f);function p(v){q(y,n,u,p,m,"next",v)}function m(v){q(y,n,u,p,m,"throw",v)}p(void 0)})}}function z(i,a){for(var f=0;f<a.length;f++){var n=a[f];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,rt(n.key),n)}}function $(i,a,f){return a&&z(i.prototype,a),f&&z(i,f),Object.defineProperty(i,"prototype",{writable:!1}),i}function X(i,a){i.prototype=Object.create(a.prototype),i.prototype.constructor=i,C(i,a)}function B(i){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(f){return f.__proto__||Object.getPrototypeOf(f)},B(i)}function C(i,a){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,u){return n.__proto__=u,n},C(i,a)}function Z(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function G(i,a,f){return Z()?G=Reflect.construct.bind():G=function(u,y,p){var m=[null];m.push.apply(m,y);var v=Function.bind.apply(u,m),l=new v;return p&&C(l,p.prototype),l},G.apply(null,arguments)}function V(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function J(i){var a=typeof Map=="function"?new Map:void 0;return J=function(n){if(n===null||!V(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof a<"u"){if(a.has(n))return a.get(n);a.set(n,u)}function u(){return G(n,arguments,B(this).constructor)}return u.prototype=Object.create(n.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),C(u,n)},J(i)}function tt(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function et(i,a){if(typeof i!="object"||i===null)return i;var f=i[Symbol.toPrimitive];if(f!==void 0){var n=f.call(i,a||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(i)}function rt(i){var a=et(i,"string");return typeof a=="symbol"?a:String(a)}var nt=function(i){X(a,i);function a(){var n;return n=i.call(this)||this,n.instance="",n.host=window.location.origin,n.element=n.querySelector("textarea"),n.refresh=n.refresh.bind(tt(n)),n.intersectionObserver=new IntersectionObserver(function(u){u[0].isIntersecting&&n.instance&&n.instance.refresh()},{threshold:0}),n}var f=a.prototype;return f.attributeChangedCallback=function(u,y,p){switch(u){case"options":y&&p!==y&&this.refresh(this.element);break}},f.connectedCallback=function(){var n=Q(R().mark(function y(){var p=this,m,v,l;return R().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return m=this.getAttribute("editor"),v=this.getAttribute("addons"),_.next=4,import(this.host+"/"+m);case 4:if(!this.options.keyMapUrl){_.next=7;break}return _.next=7,import(this.host+"/"+this.options.keyMapUrl);case 7:return _.next=9,import(this.host+"/"+v);case 9:l=this,window.CodeMirror.modeURL=this.getAttribute("mod-path"),window.CodeMirror.defineInitHook(function(g){var S,x=window.CodeMirror.findModeByName(g.options.mode||"")||window.CodeMirror.findModeByExtension(g.options.mode||"");window.CodeMirror.autoLoadMode(g,typeof x=="object"?x.mode:g.options.mode),x&&x.mime&&(["text/x-php","application/x-httpd-php","application/x-httpd-php-open"].includes(x.mime)?g.setOption("mode","php"):x.mime==="text/html"?g.setOption("mode",x.mode):g.setOption("mode",x.mime));var P=function(){l.instance.setOption("fullScreen",!l.instance.getOption("fullScreen"));var d=document.getElementById("subhead");if(d){var E=document.getElementById("header");E.classList.toggle("hidden"),d.classList.toggle("hidden"),l.instance.display.wrapper.style.top=d.getBoundingClientRect().height+"px"}},k=function(){if(l.instance.getOption("fullScreen"),l.instance.setOption("fullScreen",!1),!l.instance.getOption("fullScreen")){var d=document.getElementById("subhead");if(d){var E=document.getElementById("header");d.classList.toggle("hidden"),E.classList.toggle("hidden"),l.instance.display.wrapper.style.top=d.getBoundingClientRect().height+"px"}}},A=(S={"Ctrl-Q":P},S[l.getAttribute("fs-combo")]=P,S.Esc=k,S);g.addKeyMap(A);var N=function(){var d=document.createElement("div");return d.className="CodeMirror-markergutter-mark",d};g.on("gutterClick",function(b,d,E){if(E==="CodeMirror-markergutter"){var M=b.lineInfo(d),L=!!M.gutterMarkers&&!!M.gutterMarkers["CodeMirror-markergutter"];b.setGutterMarker(d,"CodeMirror-markergutter",L?null:N())}}),l.parentNode.tagName.toLowerCase()==="fieldset"&&(l.parentNode.style.minWidth=0)}),this.instance=window.CodeMirror.fromTextArea(this.element,this.options),this.instance.disable=function(g){return p.setOption("readOnly",g?"nocursor":!1)},Joomla.editors.instances[this.element.id]=this.instance,this.intersectionObserver.observe(this);case 16:case"end":return _.stop()}},y,this)}));function u(){return n.apply(this,arguments)}return u}(),f.disconnectedCallback=function(){delete Joomla.editors.instances[this.element.id],this.intersectionObserver.unobserve(this)},f.refresh=function(u){this.instance.fromTextArea(u,this.options)},$(a,[{key:"options",get:function(){return JSON.parse(this.getAttribute("options"))},set:function(u){this.setAttribute("options",u)}}],[{key:"observedAttributes",get:function(){return["options"]}}]),a}(J(HTMLElement));customElements.define("joomla-editor-codemirror",nt)})();
