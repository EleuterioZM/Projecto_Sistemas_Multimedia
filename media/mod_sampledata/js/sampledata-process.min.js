/**
 * @copyright  (C) 2018 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */const SampleData={inProgress:!1},sampledataAjax=(e,t,s)=>{const m=`index.php?option=com_ajax&format=json&group=sampledata&${Joomla.getOptions("csrf.token")}=1`,c=Joomla.getOptions("sample-data"),o=document.createElement("div");o.classList.add(`sampledata-steps-${e}-${s}`),o.setAttribute("role","region"),o.setAttribute("aria-live","polite");const n=document.createElement("p");n.classList.add("loader-image"),n.classList.add("text-center");const i=document.createElement("img");i.setAttribute("src",c.icon),i.setAttribute("width",30),i.setAttribute("height",30),n.appendChild(i),o.appendChild(n),document.querySelector(`.sampledata-progress-${e}`).appendChild(o),Joomla.request({url:`${m}&type=${e}&plugin=SampledataApplyStep${s}&step=${s}`,method:"GET",perform:!0,onSuccess:A=>{const p=o.querySelector(".loader-image");p.parentNode.removeChild(p);let l={};try{l=JSON.parse(A)}catch{Joomla.renderMessages({error:[Joomla.Text._("MOD_SAMPLEDATA_INVALID_RESPONSE")]},`.sampledata-steps-${e}-${s}`),SampleData.inProgress=!1;return}let g="",d;if(l.success&&l.data&&l.data.length>0){const a=document.querySelector(`.sampledata-progress-${e} .progress-bar`);if(l.data.forEach(r=>{r!==null&&(d=r.success,g=d?"bg-success":"bg-danger",d?Joomla.renderMessages({message:[r.message]},`.sampledata-steps-${e}-${s}`,!1,3e3):Joomla.renderMessages({error:[r.message]},`.sampledata-steps-${e}-${s}`,!1))}),a.innerText=`${s}/${t}`,a.style.width=`${s/t*100}%`,a.setAttribute("aria-valuemin",0),a.setAttribute("aria-valuemax",100),a.setAttribute("aria-valuenow",s/t*100),a.classList.add(g),d&&s<=t){const r=s+1;if(r<=t)sampledataAjax(e,t,r);else{const u=document.querySelector(`.sampledata-progress-${e}`);u.parentNode.removeChild(u),Joomla.renderMessages({message:[Joomla.Text._("MOD_SAMPLEDATA_COMPLETED")]}),window.scroll({top:0,left:0,behavior:"smooth"}),SampleData.inProgress=!1}}}else Joomla.renderMessages({error:[Joomla.Text._("MOD_SAMPLEDATA_INVALID_RESPONSE")]}),window.scroll({top:0,left:0,behavior:"smooth"}),SampleData.inProgress=!1},onError:()=>{Joomla.renderMessages({error:[Joomla.Text._("MOD_SAMPLEDATA_ERROR_RESPONSE")]}),window.scroll({top:0,left:0,behavior:"smooth"}),SampleData.inProgress=!1}})},sampledataApply=e=>{const t=e.getAttribute("data-type"),s=e.getAttribute("data-steps");if(SampleData.inProgress)return;if(e.getAttribute("data-processed")){alert(Joomla.Text._("MOD_SAMPLEDATA_ITEM_ALREADY_PROCESSED")),SampleData.inProgress=!1;return}return window.confirm(Joomla.Text._("MOD_SAMPLEDATA_CONFIRM_START"))&&([].slice.call(document.querySelectorAll(`.sampledata-progress-${t}`)).forEach(c=>{c.classList.remove("d-none")}),e.setAttribute("data-processed",!0),SampleData.inProgress=!0,sampledataAjax(t,s,1)),!1},sampleDataWrapper=document.getElementById("sample-data-wrapper");sampleDataWrapper&&[].slice.call(sampleDataWrapper.querySelectorAll(".apply-sample-data")).forEach(t=>{t.addEventListener("click",({currentTarget:s})=>sampledataApply(s))});
