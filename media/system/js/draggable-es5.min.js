(function(){"use strict";/**
 * @copyright  (C) 2019 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */var d,c,g,f,m,t=document.querySelector(".js-draggable"),p,i;if(t)d=t.dataset.url,c=t.dataset.direction,g=t.dataset.nested;else if(Joomla.getOptions("draggable-list")){var s=Joomla.getOptions("draggable-list");t=document.querySelector(s.id),t.classList.contains("js-draggable")||t.classList.add("js-draggable"),d=s.url,c=s.direction,g=s.nested}if(t){p=t.closest("form"),i=new FormData(p),i.delete("task"),i.delete("order[]"),document.addEventListener("touchstart",function(){},!1);var S=function(e,u,l,r){var a,n=[];if(l<r)for(e[r].value=e[r-1].value,a=l;a<r;a+=1)c==="asc"?e[a].value=parseInt(e[a].value,10)-1:e[a].value=parseInt(e[a].value,10)+1;else for(e[r].value=e[r+1].value,a=r+1;a<=l;a+=1)c==="asc"?e[a].value=parseInt(e[a].value,10)+1:e[a].value=parseInt(e[a].value,10)-1;for(a=0;a<e.length-1;a+=1)n.push("order[]="+encodeURIComponent(e[a].value)),n.push("cid[]="+encodeURIComponent(u[a].value));return n},y=function(e){if(e.dataset.itemId){var u=e.dataset.itemId,l=t.querySelectorAll('tr[data-parents~="'+u+'"]');l.length&&e.after.apply(e,l)}},h=function(e){var u,l,r,a=e.dataset.draggableGroup;a?(r='tr[data-draggable-group="'+a+'"]',u='[data-draggable-group="'+a+'"] [name="order[]"]',l='[data-draggable-group="'+a+'"] [name="cid[]"]'):(r="tr",u='[name="order[]"]',l='[name="cid[]"]');var n=[].slice.call(t.querySelectorAll(r)),q=[].slice.call(t.querySelectorAll(u)),b=[].slice.call(t.querySelectorAll(l));if(m=n.indexOf(e),d){var v=document.querySelector('[name="task"]');v&&v.setAttribute("name","some__Temporary__Name__");var O={url:d,method:"POST",data:new URLSearchParams(i).toString()+"&"+S(q,b,f,m).join("&"),perform:!0};Joomla.request(O),v&&v.setAttribute("name","task")}y(e)};dragula([t],{direction:"vertical",copy:!1,revertOnSpill:!0,accepts:function(e,u,l,r){return g&&r!==null?r.dataset.draggableGroup&&r.dataset.draggableGroup===e.dataset.draggableGroup:r===null||r&&r.tagName.toLowerCase()==="tr"},mirrorContainer:t}).on("drag",function(o){var e,u=o.dataset.draggableGroup;u?e='tr[data-draggable-group="'+u+'"]':e="tr";var l=[].slice.call(t.querySelectorAll(e));f=l.indexOf(o)}).on("drop",function(o){h(o)})}})();
