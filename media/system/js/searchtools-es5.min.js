(function(){"use strict";Joomla=window.Joomla||{},function(h){h.resetFilters=function(d){var o=d.form;if(!o)throw new Error("Element must be inside a form!");var n=[].slice.call(o.elements);if(n.length){var t=[];n.forEach(function(e){e.getAttribute("name")==="task"||e.getAttribute("name")==="boxchecked"||e.value==="1"&&/^[0-9A-F]{32}$/i.test(e.name)||e===d||t.push(e)}),t.forEach(function(e){e.value=""}),o.submit()}};var g=function(){function d(n,t){var e=this,r={formSelector:".js-stools-form",searchFieldSelector:".js-stools-field-search",clearBtnSelector:".js-stools-btn-clear",mainContainerSelector:".js-stools",searchBtnSelector:".js-stools-btn-search",filterBtnSelector:".js-stools-btn-filter",filterContainerSelector:".js-stools-container-filters",filtersHidden:!0,listBtnSelector:".js-stools-btn-list",listContainerSelector:".js-stools-container-list",listHidden:!0,orderColumnSelector:".js-stools-column-order",orderBtnSelector:".js-stools-btn-order",orderFieldSelector:".js-stools-field-order",orderFieldName:"list[fullordering]",limitFieldSelector:".js-stools-field-limit",defaultLimit:20,activeOrder:null,activeDirection:"ASC",clearListOptions:!1,listSelectAutoSubmit:"js-select-submit-on-change",listSelectAutoReset:"js-select-reset-on-change"};this.element=n,this.options=h.extend(r,t),this.theForm=document.querySelector(this.options.formSelector),this.filterButton=document.querySelector(this.options.formSelector+" "+this.options.filterBtnSelector),this.filterContainer=document.querySelector(this.options.formSelector+" "+this.options.filterContainerSelector)?document.querySelector(this.options.formSelector+" "+this.options.filterContainerSelector):"",this.filtersHidden=this.options.filtersHidden,this.listButton=document.querySelector(this.options.listBtnSelector),this.listContainer=document.querySelector(this.options.formSelector+" "+this.options.listContainerSelector),this.listHidden=this.options.listHidden,this.mainContainer=document.querySelector(this.options.mainContainerSelector),this.searchButton=document.querySelector(this.options.formSelector+" "+this.options.searchBtnSelector),this.searchField=document.querySelector(this.options.formSelector+" "+this.options.searchFieldSelector),this.searchString=null,this.clearButton=document.querySelector(this.options.clearBtnSelector),this.orderCols=Array.prototype.slice.call(document.querySelectorAll(this.options.formSelector+" "+this.options.orderColumnSelector)),this.orderField=document.querySelector(this.options.formSelector+" "+this.options.orderFieldSelector),this.limitField=document.querySelector(this.options.formSelector+" "+this.options.limitFieldSelector),this.activeColumn=null,this.activeDirection=this.options.activeDirection,this.activeOrder=this.options.activeOrder,this.activeLimit=null,this.clearListOptions=this.options.clearListOptions;var i=this;this.searchString=this.searchField?this.searchField.value:"",this.showFilters=this.showFilters.bind(this),this.hideFilters=this.hideFilters.bind(this),this.showList=this.showList.bind(this),this.hideList=this.hideList.bind(this),this.toggleFilters=this.toggleFilters.bind(this),this.toggleList=this.toggleList.bind(this),this.checkFilter=this.checkFilter.bind(this),this.clear=this.clear.bind(this),this.createOrderField=this.createOrderField.bind(this),this.checkActiveStatus=this.checkActiveStatus.bind(this),this.activeFilter=this.activeFilter.bind(this),this.deactiveFilter=this.deactiveFilter.bind(this),this.getFilterFields=this.getFilterFields.bind(this),this.getListFields=this.getListFields.bind(this),this.hideContainer=this.hideContainer.bind(this),this.showContainer=this.showContainer.bind(this),this.toggleContainer=this.toggleContainer.bind(this),this.toggleDirection=this.toggleDirection.bind(this),this.updateFieldValue=this.updateFieldValue.bind(this),this.findOption=this.findOption.bind(this),this.filterContainer&&this.filterContainer.classList.contains("js-stools-container-filters-visible")?(this.showFilters(),this.showList()):(this.hideFilters(),this.hideList()),this.filterButton&&this.filterButton.addEventListener("click",function(s){i.toggleFilters(),s.stopPropagation(),s.preventDefault()}),this.listButton&&this.listButton.addEventListener("click",function(s){i.toggleList(),s.stopPropagation(),s.preventDefault()}),this.getFilterFields().forEach(function(s){var l=!s.classList.contains(e.options.listSelectAutoSubmit)&&s.closest("joomla-field-fancy-select."+e.options.listSelectAutoSubmit),a=!s.classList.contains(e.options.listSelectAutoReset)&&s.closest("joomla-field-fancy-select."+e.options.listSelectAutoReset);i.checkFilter(s),s.addEventListener("change",function(){i.checkFilter(s),(s.classList.contains(e.options.listSelectAutoSubmit)||l)&&s.form.submit(),(s.classList.contains(e.options.listSelectAutoReset)||a)&&e.clear(s)})}),this.clearButton&&this.clearButton.addEventListener("click",i.clear),this.createOrderField(),this.orderCols.forEach(function(s){s.addEventListener("click",function(l){var a=l.target,c=a.tagName.toLowerCase()==="span"?a.parentNode:a,u=c.getAttribute("data-order"),v=c.getAttribute("data-direction"),f=u+" "+v;u.length&&(i.activeColumn=u,f!==i.activeOrder?(i.activeDirection=v,i.activeOrder=f,i.updateFieldValue(i.orderField,f)):i.toggleDirection(),i.theForm.submit())})}),this.checkActiveStatus(this)}var o=d.prototype;return o.checkFilter=function(t){if(t.tagName.toLowerCase()==="select"){var e=t.querySelector("option:checked");e&&(e.value!==""?this.activeFilter(t,this):this.deactiveFilter(t,this))}else t.value!==""?this.activeFilter(t,this):this.deactiveFilter(t,this)},o.clear=function(t){var e=this;t===void 0&&(t=null);var r=this;r.searchField&&(r.searchField.value=""),r.getFilterFields().forEach(function(i){t&&i===t||!i.closest(e.options.filterContainerSelector)||(i.value="",r.checkFilter(i),window.jQuery&&window.jQuery.chosen&&window.jQuery(i).trigger("chosen:updated"))}),r.clearListOptions&&(r.getListFields().forEach(function(i){i.value="",r.checkFilter(i),window.jQuery&&window.jQuery.chosen&&window.jQuery(i).trigger("chosen:updated")}),document.querySelector("#list_limit").value=r.options.defaultLimit,window.jQuery&&window.jQuery.chosen&&window.jQuery("#list_limit").trigger("chosen:updated")),r.theForm.submit()},o.updateFilterCount=function(t){this.clearButton&&(this.clearButton.disabled=t===0&&!this.searchString.length)},o.checkActiveStatus=function(t){var e=this,r=0;if(this.getFilterFields().forEach(function(s){s.closest(e.options.filterContainerSelector)&&s.classList.contains("active")&&(r+=1,t.filterButton&&(t.filterButton.classList.remove("btn-secondary"),t.filterButton.classList.add("btn-primary")))}),r===0){var i=document.getElementById("filteredBy");i&&i.parentNode.removeChild(i)}this.clearButton&&(this.clearButton.disabled=r===0&&!this.searchString.length)},o.activeFilter=function(t){t.classList.add("active");var e="#"+t.getAttribute("id"),r=t.querySelector(e);r&&r.classList.add("active");var i=document.getElementById("filteredBy"),s=Object.prototype.hasOwnProperty.call(t.attributes,"type")&&t.attributes.type.value==="hidden";if(i&&!s){var l="";if(t.tagName.toLowerCase()==="select")if(t.multiple===!0){var a=t.querySelectorAll("option:checked"),c=[].slice.call(a).map(function(u){return u.text});l=t.labels[0].textContent+" - "+c.join()}else l=t.labels[0].textContent+" - "+t.options[t.selectedIndex].text;else l=t.labels[0].textContent+" - "+t.value;i.textContent+=l}},o.deactiveFilter=function(t){t.classList.remove("active");var e="#"+t.getAttribute("id"),r=t.querySelector(e);r&&r.classList.remove("active")},o.getFilterFields=function(){return this.mainContainer?Array.prototype.slice.call(this.mainContainer.querySelectorAll("select,input")):this.filterContainer?Array.prototype.slice.call(this.filterContainer.querySelectorAll("select,input")):[]},o.getListFields=function(){return Array.prototype.slice.call(this.listContainer.querySelectorAll("select"))},o.hideContainer=function(t){t&&(t.classList.remove("js-stools-container-filters-visible"),document.body.classList.remove("filters-shown"))},o.showContainer=function(t){t.classList.add("js-stools-container-filters-visible"),document.body.classList.add("filters-shown")},o.toggleContainer=function(t){t.classList.contains("js-stools-container-filters-visible")?this.hideContainer(t):this.showContainer(t)},o.hideList=function(){this.hideContainer(this.filterContainer)},o.showList=function(){this.showContainer(this.filterContainer)},o.toggleList=function(){this.toggleContainer(this.filterContainer)},o.hideFilters=function(){this.hideContainer(this.filterContainer)},o.showFilters=function(){this.showContainer(this.filterContainer)},o.toggleFilters=function(){this.toggleContainer(this.filterContainer)},o.toggleDirection=function(){var t=this,e="ASC";t.activeDirection.toUpperCase()==="ASC"&&(e="DESC"),t.activeDirection=e,t.activeOrder=t.activeColumn+" "+e,t.updateFieldValue(t.orderField,t.activeOrder)},o.createOrderField=function(){var t=this,e=this;if(this.orderField||(this.orderField=document.createElement("input"),this.orderField.setAttribute("type","hidden"),this.orderField.setAttribute("id","js-stools-field-order"),this.orderField.setAttribute("class","js-stools-field-order"),this.orderField.setAttribute("name",e.options.orderFieldName),this.orderField.setAttribute("value",e.activeOrder+" "+this.activeDirection),this.theForm.append(this.orderField)),this.orderField.tagName.toLowerCase()==="select"){var r=[].slice.call(this.orderField.options);r.forEach(function(i){var s=i.getAttribute("data-order"),l=i.getAttribute("data-name"),a=i.getAttribute("data-direction");if(s&&s.length){s=s+" "+a;var c=e.findOption(e.orderField,s);c.length||(c=document.createElement("option"),c.text=l,c.value=s,i.classList.contains("active")&&c.setAttribute("selected","selected"),t.orderFieldName.innerHTML+=h.sanitizeHtml(c))}}),window.jQuery&&window.jQuery.chosen&&window.jQuery(this.orderField).trigger("chosen:updated")}this.activeOrder=this.orderField.value},o.updateFieldValue=function(t,e){var r=t.getAttribute("type");if(r==="hidden"||r==="text")t.setAttribute("value",e);else if(t.tagName.toLowerCase()==="select"){var i=[].slice.call(t.options),s;if(i.forEach(function(a){a.value===e&&(s=a)}),s&&s.length)s.setAttribute("selected","selected");else{var l=document.createElement("option");l.text=e,l.value=e,l.setAttribute("selected","selected"),t.appendChild(l)}t.value=e,window.jQuery&&window.jQuery.chosen&&t.trigger("chosen:updated")}},o.findOption=function(t,e){for(var r=0,i=t.length;i>r;r++)if(t[r].value===e)return t[r]},d}(),F=function d(){if(h.getOptions("searchtools")){var o=h.getOptions("searchtools"),n=document.querySelector(o.selector);new g(n,o)}var t=document.getElementById("sorted"),e=document.getElementById("orderedBy");if(t&&t.hasAttribute("data-caption")&&e){var r=t.getAttribute("data-caption");e.textContent+=r}if(t&&t.hasAttribute("data-sort")){var i=t.getAttribute("data-sort");t.parentNode.setAttribute("aria-sort",i)}document.removeEventListener("DOMContentLoaded",d)};document.addEventListener("DOMContentLoaded",F)}(Joomla)})();
