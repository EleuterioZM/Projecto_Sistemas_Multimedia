/**
 * @copyright  (C) 2016 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */(function(O,c){"use strict";var o=function(e){if(!e)throw new Error(`Calendar setup failed:
  No valid element found, Please check your code`);if(typeof Date.parseFieldDate!="function")throw new Error(`Calendar setup failed:
  No valid date helper, Please check your code`);if(e._joomlaCalendar)throw new Error("JoomlaCalendar instance already exists for the element");e._joomlaCalendar=this;var a=this;if(this.writable=!0,this.hidden=!0,this.params={},this.element=e,this.inputField=e.getElementsByTagName("input")[0],this.button=e.getElementsByTagName("button")[0],!this.inputField)throw new Error(`Calendar setup failed:
  No valid input found, Please check your code`);this.params={debug:!1,clicked:!1,element:{style:{display:"none"}},writable:!0};var t=Joomla.Text._;this.strings={today:t("JLIB_HTML_BEHAVIOR_TODAY","Today"),wk:t("JLIB_HTML_BEHAVIOR_WK","wk"),days:["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],shortDays:["SUN","MON","TUE","WED","THU","FRI","SAT"],months:["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],shortMonths:["JANUARY_SHORT","FEBRUARY_SHORT","MARCH_SHORT","APRIL_SHORT","MAY_SHORT","JUNE_SHORT","JULY_SHORT","AUGUST_SHORT","SEPTEMBER_SHORT","OCTOBER_SHORT","NOVEMBER_SHORT","DECEMBER_SHORT"],am:t("JLIB_HTML_BEHAVIOR_AM","am"),pm:t("JLIB_HTML_BEHAVIOR_PM","pm"),exit:t("JCLOSE","Close"),clear:t("JCLEAR","Clear")},this.strings.days=this.strings.days.map(function(n){return t(n)}),this.strings.shortDays=this.strings.shortDays.map(function(n){return t(n)}),this.strings.months=this.strings.months.map(function(n){return t(n)}),this.strings.shortMonths=this.strings.shortMonths.map(function(n){return t(n)});var s=this.button,d={inputField:this.inputField,dateType:s.dataset.dateType||"gregorian",direction:c.dir?c.dir:c.getElementsByTagName("html")[0].getAttribute("dir"),firstDayOfWeek:s.dataset.firstday?parseInt(s.dataset.firstday,10):0,dateFormat:s.dataset.dateFormat||"%Y-%m-%d %H:%M:%S",weekend:[0,6],minYear:1e3,maxYear:2100,time24:!0,showsOthers:!0,showsTime:!0,weekNumbers:!0,showsTodayBtn:!0,compressedHeader:!1};"showOthers"in s.dataset&&(d.showsOthers=parseInt(s.dataset.showOthers,10)===1),"weekNumbers"in s.dataset&&(d.weekNumbers=parseInt(s.dataset.weekNumbers,10)===1),"onlyMonthsNav"in s.dataset&&(d.compressedHeader=parseInt(s.dataset.onlyMonthsNav,10)===1),"time24"in s.dataset&&(d.time24=parseInt(s.dataset.time24,10)===24),"showTime"in s.dataset&&(d.showsTime=parseInt(s.dataset.showTime,10)===1),"todayBtn"in s.dataset&&(d.showsTodayBtn=parseInt(s.dataset.todayBtn,10)===1);for(var i in d)this.params[i]=d[i];s.dataset.minYear&&(a.params.minYear=P(parseInt(s.dataset.minYear,10),a.params.dateType)),s.dataset.maxYear&&(a.params.maxYear=P(parseInt(s.dataset.maxYear,10),a.params.dateType)),s.dataset.weekend&&(a.params.weekend=s.dataset.weekend.split(",").map(function(n){return parseInt(n,10)})),this.params.direction==="rtl"&&(this.strings.days=this.strings.days.reverse(),this.strings.shortDays=this.strings.shortDays.reverse()),this.strings.months=Date.monthsToLocalOrder(this.strings.months,this.params.dateType),this.strings.shortMonths=Date.monthsToLocalOrder(this.strings.shortMonths,this.params.dateType),this._dayMouseDown=function(n){return a._handleDayMouseDown(n)},this._calKeyEvent=function(n){return a._handleCalKeyEvent(n)},this._documentClick=function(n){return a._handleDocumentClick(n)},this.checkInputs(),!this.inputField.getAttribute("readonly")&&(this._create(),this._bindEvents())};o.prototype.checkInputs=function(){var e=Date.parseFieldDate(this.inputField.getAttribute("data-alt-value"),this.params.dateFormat,"gregorian",this.strings);this.inputField.value!==""?(this.date=e,this.inputField.value=e.print(this.params.dateFormat,this.params.dateType,!0,this.strings)):this.date=new Date},o.prototype.recreate=function(){var e=this.element,a=e.querySelector(".js-calendar");a&&(e._joomlaCalendar=null,a.parentNode.removeChild(a),new o(e))},o.prototype.updateTime=function(e,a,t){var s=this,d=s.date,i=s.date.getLocalDate(s.params.dateType),n=s.date.getLocalMonth(s.params.dateType),l=s.date.getLocalFullYear(s.params.dateType),p=this.inputField.parentNode.parentNode.querySelectorAll(".time-ampm")[0];s.params.time24||(/pm/i.test(p.value)&&e<12?e=parseInt(e)+12:/am/i.test(p.value)&&e==12&&(e=0)),d.setHours(e),d.setMinutes(parseInt(a,10)),d.setSeconds(d.getSeconds()),d.setLocalFullYear(s.params.dateType,l),d.setLocalMonth(s.params.dateType,n),d.setLocalDate(s.params.dateType,i),s.dateClicked=!1,this.callHandler()},o.prototype.setDate=function(e){e.equalsTo(this.date)||(this.date=e,this.processCalendar(this.params.firstDayOfWeek,e))},o.prototype.moveCursorBy=function(e){var a=new Date(this.date);a.setDate(a.getDate()-e),this.setDate(a)},o.prototype.resetSelected=function(e){for(var a=e.options,t=a.length;t--;){var s=a[t];s.selected&&(s.selected=!1)}},o.prototype.callHandler=function(){this.inputField.setAttribute("data-alt-value",this.date.print(this.params.dateFormat,"gregorian",!1,this.strings)),this.inputField.getAttribute("data-alt-value")&&this.inputField.getAttribute("data-alt-value")!=="0000-00-00 00:00:00"&&(this.inputField.value=this.date.print(this.params.dateFormat,this.params.dateType,!0,this.strings),this.params.dateType!=="gregorian"&&this.inputField.setAttribute("data-local-value",this.date.print(this.params.dateFormat,this.params.dateType,!0,this.strings))),this.inputField.value=this.date.print(this.params.dateFormat,this.params.dateType,!0,this.strings),this.dateClicked&&typeof this.params.onUpdate=="function"&&this.params.onUpdate(this),this.inputField.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!0})),this.dateClicked?this.close():this.processCalendar()},o.prototype.close=function(){this.hide()},o.prototype.show=function(){this.checkInputs(),this.inputField.focus(),this.dropdownElement.classList.add("open"),this.dropdownElement.removeAttribute("hidden"),this.hidden=!1,c.addEventListener("keydown",this._calKeyEvent,!0),c.addEventListener("keypress",this._calKeyEvent,!0),c.addEventListener("mousedown",this._documentClick,!0);var e=this.element.querySelector(".js-calendar");O.innerHeight<e.getBoundingClientRect().bottom+20?e.style.marginTop=-(e.getBoundingClientRect().height+this.inputField.getBoundingClientRect().height)+"px":e.style.marginTop="initial",this.processCalendar()},o.prototype.hide=function(){c.removeEventListener("keydown",this._calKeyEvent,!0),c.removeEventListener("keypress",this._calKeyEvent,!0),c.removeEventListener("mousedown",this._documentClick,!0),this.dropdownElement.classList.remove("open"),this.dropdownElement.setAttribute("hidden",""),this.hidden=!0},o.prototype._handleDocumentClick=function(e){var a=e.target;if(a!==null&&!a.classList.contains("time"))for(;a!==null&&a!==this.element;a=a.parentNode);if(a===null)return c.activeElement.blur(),this.hide(),R(e)},o.prototype._handleDayMouseDown=function(e){var a=this,t=e.currentTarget,s=e.target||e.srcElement;if(!(s&&s.hasAttribute("data-action"))){if(t.nodeName!=="TD"){var d=t.getParent("TD");d.nodeName==="TD"?t=d:(t=t.getParent("TD"),t.classList.contains("js-calendar")&&(t=t.getElementsByTagName("table")[0]))}else if(!s.classList.contains("js-btn")&&!t.classList.contains("day")&&!t.classList.contains("title"))return;if(!t||t.disabled)return!1;if(typeof t.navtype>"u"||t.navtype!==300){t.navtype===50&&(t._current=t.innerHTML),(s===t||s.parentNode===t)&&a.cellClick(t,e);var i=null;typeof t.month<"u"&&(i=t),typeof t.parentNode.month<"u"&&(i=t.parentNode);var n=null;if(i)n=new Date(a.date),i.month!==n.getLocalMonth(a.params.dateType)&&(n.setLocalMonth(a.params.dateType,i.month),a.setDate(n),a.dateClicked=!1,this.callHandler());else{var l=null;typeof t.year<"u"&&(l=s),typeof t.parentNode.year<"u"&&(l=s.parentNode),l&&(n=new Date(a.date),l.year!==n.getLocalFullYear(a.params.dateType)&&(n.setFullYear(a.params.dateType,l.year),a.setDate(n),a.dateClicked=!1,this.callHandler()))}}return R(e)}},o.prototype.cellClick=function(e,a){var t=this,s=!1,d=!1,i=null;if(typeof e.navtype>"u"){t.currentDateEl&&(e.classList.add("selected"),t.currentDateEl=e.caldate,s=t.currentDateEl===e.caldate,s||(t.currentDateEl=e.caldate)),t.date.setLocalDateOnly("gregorian",e.caldate);var n=!(t.dateClicked=!e.otherMonth);t.currentDateEl&&(d=!e.disabled),n&&this.processCalendar()}else{i=new Date(t.date),t.dateClicked=!1;var l=i.getOtherFullYear(t.params.dateType),p=i.getLocalMonth(t.params.dateType);switch(e.navtype){case 400:break;case-2:t.params.compressedHeader||l>t.params.minYear&&i.setOtherFullYear(t.params.dateType,l-1);break;case-1:var r=i.getLocalDate(t.params.dateType);if(p>0){var g=i.getLocalMonthDays(t.params.dateType,p-1);r>g&&i.setLocalDate(t.params.dateType,g),i.setLocalMonth(t.params.dateType,p-1)}else if(l-- >t.params.minYear){i.setOtherFullYear(t.params.dateType,l);var g=i.getLocalMonthDays(t.params.dateType,11);r>g&&i.setLocalDate(t.params.dateType,g),i.setLocalMonth(t.params.dateType,11)}break;case 1:var r=i.getLocalDate(t.params.dateType);if(p<11){var g=i.getLocalMonthDays(t.params.dateType,p+1);r>g&&i.setLocalDate(t.params.dateType,g),i.setLocalMonth(t.params.dateType,p+1)}else if(l<t.params.maxYear){i.setOtherFullYear(t.params.dateType,l+1);var g=i.getLocalMonthDays(t.params.dateType,0);r>g&&i.setLocalDate(t.params.dateType,g),i.setLocalMonth(t.params.dateType,0)}break;case 2:t.params.compressedHeader||l<t.params.maxYear&&i.setOtherFullYear(t.params.dateType,l+1);break;case 0:break}i.equalsTo(t.date)?e.navtype===0&&(d=s=!0):(this.setDate(i),d=!0)}d&&(t.params.showsTime&&(this.dateClicked=!1),a&&this.callHandler()),e.classList.remove("hilite"),s&&!t.params.showsTime&&(t.dateClicked=!1,a&&this.close())},o.prototype._handleCalKeyEvent=function(e){var a=this,t=e.keyCode;if(e.target===this.inputField&&(t===13||t===9)&&this.close(),a.params.direction==="rtl"&&(t===37?t=39:t===39&&(t=37)),t===32&&e.shiftKey&&(e.preventDefault(),this.cellClick(a._nav_now,e),a.close()),t===27&&this.close(),t===38&&this.moveCursorBy(7),t===40&&this.moveCursorBy(-7),t===37&&this.moveCursorBy(1),t===39&&this.moveCursorBy(-1),e.target===this.inputField&&!(t>48||t<57||t===186||t===189||t===190||t===32))return R(e)},o.prototype._create=function(){var e=this,a=this.element,t=u("table"),s=u("div");this.table=t,t.className="table",t.style.marginBottom=0,this.dropdownElement=s,a.appendChild(s),this.params.direction&&(s.style.direction=this.params.direction),s.className="js-calendar",s.style.position="absolute",s.style.boxShadow="0 0 70px 0 rgba(0,0,0,0.67)",s.style.minWidth=this.inputField.width,s.style.padding="0",s.setAttribute("hidden",""),s.style.left="auto",s.style.top="auto",s.style.zIndex=1060,s.style.borderRadius="20px",this.wrapper=u("div"),this.wrapper.className="calendar-container",s.appendChild(this.wrapper),this.wrapper.appendChild(t);var d=u("thead",t);d.className="calendar-header";var r=null,i=null,n=this,l=function(N,m,v,F,b,f,C){F=F||"td",b=b||{},r=u(F,i),m&&(f=f?'class="'+f+'"':"",r.colSpan=m);for(var w in b)r.style[w]=b[w];for(var w in C)r.setAttribute(w,C[w]);return v!==0&&Math.abs(v)<=2&&(r.className+=" nav"),m&&r.addEventListener("mousedown",e._dayMouseDown,!0),r.calendar=n,r.navtype=v,v!==0&&Math.abs(v)<=2?r.innerHTML=Joomla.sanitizeHtml("<a "+f+" style='display:inline;padding:2px 6px;cursor:pointer;text-decoration:none;' unselectable='on'>"+N+"</a>"):(r.innerHTML=m?Joomla.sanitizeHtml("<div unselectable='on'"+f+">"+N+"</div>"):Joomla.sanitizeHtml(N),!m&&f&&(r.className=f)),r};this.params.compressedHeader===!1&&(i=u("tr",d),i.className="calendar-head-row",this._nav_py=l("&lsaquo;",1,-2,"",{"text-align":"center","font-size":"18px","line-height":"18px"},"js-btn btn-prev-year"),this.title=l('<div style="text-align:center;font-size:18px"><span></span></div>',this.params.weekNumbers?6:5,300),this.title.className="title title-year",this._nav_ny=l(" &rsaquo;",1,2,"",{"text-align":"center","font-size":"18px","line-height":"18px"},"js-btn btn-next-year")),i=u("tr",d),i.className="calendar-head-row",this._nav_pm=l("&lsaquo;",1,-1,"",{"text-align":"center","font-size":"2em","line-height":"1em"},"js-btn btn-prev-month"),this._nav_month=l('<div style="text-align:center;font-size:1.2em"><span></span></div>',this.params.weekNumbers?6:5,888,"td",{textAlign:"center"}),this._nav_month.className="title title-month",this._nav_nm=l(" &rsaquo;",1,1,"",{"text-align":"center","font-size":"2em","line-height":"1em"},"js-btn btn-next-month"),i=u("tr",d),i.className=e.params.weekNumbers?"daynames wk":"daynames",this.params.weekNumbers&&(r=u("td",i),r.className="day-name wn",r.textContent=e.strings.wk);for(var p=7;p>0;--p)r=u("td",i),p||(r.calendar=e);this.firstdayname=this.params.weekNumbers?i.firstChild.nextSibling:i.firstChild;for(var g=this.params.firstDayOfWeek,r=this.firstdayname,D=this.params.weekend,p=0;p<7;++p){var I=(p+g)%7;r.classList.add("day-name"),this.params.weekNumbers&&r.classList.add("day-name-week"),p&&(r.calendar=e,r.fdow=I),D.indexOf(D)!==-1&&r.classList.add("weekend"),r.textContent=this.strings.shortDays[(p+g)%7],r=r.nextSibling}var E=u("tbody",t);for(this.tbody=E,p=6;p>0;--p){i=u("tr",E),this.params.weekNumbers&&(r=u("td",i));for(var T=7;T>0;--T)r=u("td",i),r.calendar=this,r.addEventListener("mousedown",this._dayMouseDown,!0)}if(this.params.showsTime){i=u("tr",E),i.className="time";var r=u("td",i);r.className="time time-title",r.colSpan=1,r.style.verticalAlign="middle",r.innerHTML=" ";var S=u("td",i);S.className="time hours-select",S.colSpan=e.params.time24?3:2;var H=u("td",i);H.className="time minutes-select",H.colSpan=e.params.time24?3:2,function(){function m(y,K,V,z,j){var L=u("select",j),J;L.calendar=e,L.className=y,L.setAttribute("data-chosen",!0),L.style.width="100%",L.navtype=50,L._range=[];for(var k=V;k<=z;++k){var U,q="";k===K&&(q=!0),k<10&&z>=10?(J="0"+k,U=Date.convertNumbers("0")+Date.convertNumbers(k)):(J=""+k,U=""+Date.convertNumbers(k)),L.options.add(new Option(U,J,q,q))}return L}var v=e.date.getHours(),F=e.date.getMinutes(),b=!e.params.time24,f=e.date.getHours()>12;b&&f&&(v-=12);var C=m("time time-hours",v,b?1:0,b?12:23,S),w=m("time time-minutes",F,0,59,H),x=null;if(b){r=u("td",i),r.className="time ampm-select",r.colSpan=e.params.weekNumbers?3:2;var M=!0,B=Date.parseFieldDate(e.inputField.getAttribute("data-alt-value"),e.params.dateFormat,"gregorian",e.strings);f=B.getHours()>=12;var A=u("select",r);A.className="time-ampm",A.style.width="100%",A.options.add(new Option(e.strings.pm,"pm",f?M:"",f?M:"")),A.options.add(new Option(e.strings.am,"am",f?"":M,f?"":M)),x=A,x.addEventListener("change",function(y){e.updateTime(y.target.parentNode.parentNode.childNodes[1].childNodes[0].value,y.target.parentNode.parentNode.childNodes[2].childNodes[0].value,y.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},!1)}else e.params.weekNumbers&&(r=u("td",i),r.innerHTML="&#160;",r.colSpan=1);C.addEventListener("change",function(y){e.updateTime(y.target.parentNode.parentNode.childNodes[1].childNodes[0].value,y.target.parentNode.parentNode.childNodes[2].childNodes[0].value,y.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},!1),w.addEventListener("change",function(y){e.updateTime(y.target.parentNode.parentNode.childNodes[1].childNodes[0].value,y.target.parentNode.parentNode.childNodes[2].childNodes[0].value,y.target.parentNode.parentNode.childNodes[3].childNodes[0].value)},!1)}()}i=u("div",this.wrapper),i.className="buttons-wrapper btn-group",this._nav_clear=l(this.strings.clear,"",100,"button","","js-btn btn btn-clear",{type:"button","data-action":"clear"});var Y=i.querySelector('[data-action="clear"]');if(Y.addEventListener("click",function(N){N.preventDefault();for(var m=e.table.querySelectorAll("td"),v=0;v<m.length;v++)if(m[v].classList.contains("selected")){m[v].classList.remove("selected");break}e.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00"),e.inputField.setAttribute("value",""),e.inputField.value="",e.inputField.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!0}))}),this.params.showsTodayBtn){this._nav_now=l(this.strings.today,"",0,"button","","js-btn btn btn-today",{type:"button","data-action":"today"});var _=this.wrapper.querySelector('[data-action="today"]');_.addEventListener("click",function(N){N.preventDefault(),e.date.setLocalDateOnly("gregorian",new Date),e.dateClicked=!0,e.callHandler(),e.close()})}this._nav_exit=l(this.strings.exit,"",999,"button","","js-btn btn btn-exit",{type:"button","data-action":"exit"});var h=this.wrapper.querySelector('[data-action="exit"]');h.addEventListener("click",function(N){N.preventDefault(),e.dateClicked||(e.inputField.value?(e.params.dateType!=="gregorian"&&e.inputField.setAttribute("data-local-value",e.inputField.value),typeof e.dateClicked>"u"?e.inputField.setAttribute("data-alt-value",Date.parseFieldDate(e.inputField.value,e.params.dateFormat,e.params.dateType,e.strings).print(e.params.dateFormat,"gregorian",!1,e.strings)):e.inputField.setAttribute("data-alt-value",e.date.print(e.params.dateFormat,"gregorian",!1,e.strings))):e.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00"),e.date=Date.parseFieldDate(e.inputField.getAttribute("data-alt-value"),e.params.dateFormat,e.params.dateType,e.strings)),e.close()}),this.processCalendar()},o.prototype.processCalendar=function(){this.table.style.visibility="hidden";var e=this.params.firstDayOfWeek,a=this.date,t=new Date,s=t.getLocalFullYear(this.params.dateType),d=t.getLocalMonth(this.params.dateType),i=t.getLocalDate(this.params.dateType),n=a.getOtherFullYear(this.params.dateType),l=a.getHours(),p=a.getMinutes(),g=a.getSeconds(),r=!this.params.time24;n<this.params.minYear?(n=this.params.minYear,a.setOtherFullYear(this.params.dateType,n)):n>this.params.maxYear&&(n=this.params.maxYear,a.setOtherFullYear(this.params.dateType,n)),this.params.firstDayOfWeek=e,this.date=new Date(a);var D=a.getLocalMonth(this.params.dateType),I=a.getLocalDate(this.params.dateType);a.setLocalDate(this.params.dateType,1);var E=(a.getLocalDay(this.params.dateType)-this.params.firstDayOfWeek)%7;E<0&&(E+=7),a.setLocalDate(this.params.dateType,-E),a.setLocalDate(this.params.dateType,a.getLocalDate(this.params.dateType)+1);for(var T=this.tbody.firstChild,S=this.ar_days=new Array,H=this.params.weekend,Y=parseInt(a.getLocalWeekDays(this.params.dateType)),_=0;_<Y;++_,T=T.nextSibling){var h=T.firstChild;this.params.weekNumbers&&(h.className="day wn",h.textContent=a.getLocalWeekNumber(this.params.dateType),h=h.nextSibling),T.className=this.params.weekNumbers?"daysrow wk":"daysrow";for(var N=!1,m,v=S[_]=[],F=Y+1,b=0;b<F;++b,h=h.nextSibling,a.setLocalDate(this.params.dateType,m+1)){h.className="day",h.style.textAlign="center",m=a.getLocalDate(this.params.dateType);var f=a.getLocalDay(this.params.dateType);h.pos=_<<4|b,v[b]=h;var C=a.getLocalMonth(this.params.dateType)===D;if(C)h.otherMonth=!1,N=!0,h.style.cursor="pointer";else if(this.params.showsOthers)h.className+=" disabled othermonth ",h.otherMonth=!0;else{h.className+=" emptycell",h.innerHTML="&#160;",h.disabled=!0;continue}h.disabled=!1,h.textContent=this.params.debug?m:Date.convertNumbers(m),h.disabled||(h.caldate=new Date(a),C&&m===I&&(h.className+=" selected",this.currentDateEl=h),a.getLocalFullYear(this.params.dateType)===s&&a.getLocalMonth(this.params.dateType)===d&&m===i&&(h.className+=" today"),H.indexOf(f)!==-1&&(h.className+=" weekend"))}N||this.params.showsOthers?(T.classList.remove("hidden"),T.removeAttribute("hidden","")):(T.classList.add("hidden"),T.setAttribute("hidden",""),T.className="emptyrow")}if(this.params.showsTime){l>12&&r&&(l-=12),l=l<10?"0"+l:l,p=p<10?"0"+p:p;var w=this.table.querySelector(".time-hours"),x=this.table.querySelector(".time-minutes");if(this.resetSelected(w),this.params.time24?w.value=l:w.value=l=="00"?"12":l,this.resetSelected(x),x.value=p,!this.params.time24){var M=new Date(this.inputField.getAttribute("data-alt-value")),B=this.table.querySelector(".time-ampm"),A=M.getHours();A>12&&(this.resetSelected(B),B.value="pm")}}if(!this.params.compressedHeader)this._nav_month.getElementsByTagName("span")[0].textContent=this.params.debug?D+" "+this.strings.months[D]:this.strings.months[D],this.title.getElementsByTagName("span")[0].textContent=this.params.debug?n+" "+Date.convertNumbers(n.toString()):Date.convertNumbers(n.toString());else{var y=Date.convertNumbers(n.toString());this._nav_month.getElementsByTagName("span")[0].textContent=this.params.monthBefore?y+" - "+this.strings.months[D]:this.strings.months[D]+" - "+y}this.table.style.visibility="visible"},o.prototype._bindEvents=function(){var e=this;this.inputField.addEventListener("blur",function(a){var t=o.getCalObject(this)._joomlaCalendar;if(!t.dropdownElement.hasAttribute("hidden")){a.preventDefault();return}if(t){if(t.inputField.value)if(typeof t.params.dateClicked>"u")if(t.inputField.setAttribute("data-local-value",t.inputField.value),t.params.dateType!=="gregorian"){var s,d=Date.parseFieldDate(t.inputField.value,t.params.dateFormat,t.params.dateType,t.strings);s=Date.localCalToGregorian(d.getFullYear(),d.getMonth(),d.getDate()),d.setFullYear(s[0]),d.setMonth(s[1]),d.setDate(s[2]),t.inputField.setAttribute("data-alt-value",d.print(t.params.dateFormat,"gregorian",!1,t.strings))}else t.inputField.setAttribute("data-alt-value",Date.parseFieldDate(t.inputField.value,t.params.dateFormat,t.params.dateType,t.strings).print(t.params.dateFormat,"gregorian",!1,t.strings));else t.inputField.setAttribute("data-alt-value",t.date.print(t.params.dateFormat,"gregorian",!1,t.strings));else t.inputField.setAttribute("data-alt-value","0000-00-00 00:00:00");t.date=Date.parseFieldDate(t.inputField.getAttribute("data-alt-value"),t.params.dateFormat,t.params.dateType,t.strings)}e.close()},!0),this.button.addEventListener("click",function(){e.show()},!1)};var R=function(e){return e||(e=O.event),e.preventDefault(),e.stopPropagation(),!1},u=function(e,a){var t=null;return t=c.createElement(e),typeof a<"u"&&a.appendChild(t),t},G=function(e){return!isNaN(e)&&function(a){return(a|0)===a}(parseFloat(e))},P=function(e,a){var t=new Date,s=t.getLocalFullYear(a);return s+e};o.getCalObject=function(e){if(!e)return!1;for(;e.parentNode;)if(e=e.parentNode,e.classList.contains("field-calendar"))return e;return!1},o.prototype.setAltValue=function(){var e=this.inputField;e.getAttribute("disabled")||(e.value=e.getAttribute("data-alt-value")&&e.getAttribute("data-alt-value")!=="0000-00-00 00:00:00"?e.getAttribute("data-alt-value"):"")},o.onSubmit=function(){if(Joomla=O.Joomla||{},!Joomla.calendarProcessed){Joomla.calendarProcessed=!0;for(var e=c.querySelectorAll(".field-calendar"),a=0;a<e.length;a++){var t=e[a],s=t._joomlaCalendar;s&&s.setAltValue()}}},o.init=function(e,a){var t=e._joomlaCalendar;t?t.recreate():new o(e),e&&e.getElementsByTagName("input")[0]&&e.getElementsByTagName("input")[0].form&&!e.getElementsByTagName("input")[0].disabled&&e.getElementsByTagName("input")[0].form.addEventListener("submit",o.onSubmit)},O.JoomlaCalendar=o;function W(e){for(var a=e.target.querySelectorAll(".field-calendar"),t=0,s=a.length;t<s;t++)o.init(a[t])}c.addEventListener("DOMContentLoaded",W),c.addEventListener("joomla:updated",W),O.Calendar={},Calendar.setup=function(e){if(e.inputField&&c.getElementById(e.inputField)){var a=c.getElementById(e.inputField),t=a.parentNode.querySelectorAll("button")[0];for(var s in e)if(e.hasOwnProperty(s))switch(s){case"ifFormat":t&&t.setAttribute("data-dayformat",e.ifFormat);break;case"firstDay":t&&t.setAttribute("data-firstday",parseInt(e.firstDay));break;case"weekNumbers":t&&t.setAttribute("data-week-numbers",e.weekNumbers==="true"||e.weekNumbers===!0?"1":"0");break;case"showOthers":t&&t.setAttribute("data-show-others",e.showOthers==="true"||e.showOthers===!0?"1":"0");break;case"showsTime":t&&t.setAttribute("data-show-time",e.showsTime==="true"||e.showsTime===!0?"1":"0");break;case"timeFormat":t&&t.setAttribute("data-time-24",parseInt(e.timeFormat));break;case"displayArea":case"inputField":case"button":case"eventName":case"daFormat":case"disableFunc":case"dateStatusFunc":case"dateTooltipFunc":case"dateText":case"align":case"range":case"flat":case"flatCallback":case"onSelect":case"onClose":case"onUpdate":case"date":case"electric":case"step":case"position":case"cache":case"multiple":break}o.init(a.parentNode.parentNode)}return null}})(window,document);
